# ============================================================================
# DevFlow Pro - Docker Environment Configuration
# ============================================================================
# This file is optimized for Docker Compose deployments.
# Use this as a reference when deploying DevFlow Pro with Docker.
#
# Key differences from standard .env:
# - Service names instead of localhost
# - Docker-specific volume paths
# - Container networking considerations
# ============================================================================

# ============================================================================
# APPLICATION SETTINGS
# ============================================================================

APP_NAME="DevFlow Pro"
APP_ENV=production
APP_KEY=
APP_DEBUG=false

# Use the Nginx service name or external domain
APP_URL=https://devflow.example.com
APP_TIMEZONE=UTC

# ============================================================================
# DATABASE CONFIGURATION (Docker Service Names)
# ============================================================================

# PostgreSQL (recommended) - use service name from docker-compose.yml
DB_CONNECTION=pgsql
DB_HOST=postgres
DB_PORT=5432
DB_DATABASE=devflow_pro
DB_USERNAME=devflow
DB_PASSWORD=your_secure_password_here

# MySQL alternative - use service name from docker-compose.yml
# DB_CONNECTION=mysql
# DB_HOST=mysql
# DB_PORT=3306
# DB_DATABASE=devflow_pro
# DB_USERNAME=devflow
# DB_PASSWORD=your_secure_password_here

# ============================================================================
# REDIS CONFIGURATION (Docker Service Name)
# ============================================================================

# Use Redis service name from docker-compose.yml
REDIS_CLIENT=predis
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=null
REDIS_DB=0
REDIS_PREFIX=devflow_

# ============================================================================
# CACHE & SESSION CONFIGURATION
# ============================================================================

CACHE_STORE=redis
CACHE_PREFIX=devflow_cache
CACHE_TTL=3600

QUEUE_CONNECTION=redis

SESSION_DRIVER=redis
SESSION_LIFETIME=120
SESSION_ENCRYPT=false
SESSION_PATH=/
SESSION_DOMAIN=null
SESSION_SECURE_COOKIE=true

# ============================================================================
# BROADCASTING & WEBSOCKETS
# ============================================================================

# Use Reverb service name from docker-compose.yml
BROADCAST_CONNECTION=reverb

REVERB_APP_ID=devflow-app
REVERB_APP_KEY=
REVERB_APP_SECRET=
REVERB_HOST=reverb
REVERB_PORT=8080
REVERB_SCHEME=http

# For production with SSL, use these instead:
# REVERB_SCHEME=https
# REVERB_PORT=443
# REVERB_HOST=devflow.example.com

# ============================================================================
# MAIL CONFIGURATION
# ============================================================================

# For Docker, you might use a mail service container
# or an external SMTP service
MAIL_MAILER=smtp
MAIL_HOST=mailhog
MAIL_PORT=1025
MAIL_USERNAME=null
MAIL_PASSWORD=null
MAIL_ENCRYPTION=null
MAIL_FROM_ADDRESS="noreply@devflow.pro"
MAIL_FROM_NAME="${APP_NAME}"

# Production SMTP (use external service)
# MAIL_HOST=smtp.gmail.com
# MAIL_PORT=587
# MAIL_USERNAME=your-email@gmail.com
# MAIL_PASSWORD=your-app-password
# MAIL_ENCRYPTION=tls

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================

LOG_CHANNEL=stack
LOG_STACK=single
LOG_DEPRECATIONS_CHANNEL=null
LOG_LEVEL=info
LOG_RETENTION_DAYS=90

# ============================================================================
# FILESYSTEM CONFIGURATION
# ============================================================================

# Use local storage with Docker volumes
FILESYSTEM_DISK=local

# AWS S3 (optional - for cloud backups)
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=us-east-1
AWS_BUCKET=
AWS_USE_PATH_STYLE_ENDPOINT=false

# ============================================================================
# DEVFLOW PRO - DOCKER PATHS
# ============================================================================

# These paths are inside the Docker container
# Map these to volumes in docker-compose.yml
DEVFLOW_PROJECTS_PATH=/var/www/projects
DEVFLOW_BACKUP_PATH=/var/www/backups
DEVFLOW_LOGS_PATH=/var/www/logs
DEVFLOW_SSL_PATH=/var/www/ssl

# ============================================================================
# DEVFLOW PRO - DEPLOYMENT SETTINGS
# ============================================================================

DEVFLOW_MAX_CONCURRENT_DEPLOYMENTS=3
DEVFLOW_DEPLOYMENT_RETENTION_DAYS=30
DEVFLOW_REQUIRE_DEPLOYMENT_APPROVAL=false
DEVFLOW_AUTO_BACKUP_BEFORE_DEPLOY=true
DEVFLOW_BACKUP_RETENTION_DAYS=7

# ============================================================================
# DEVFLOW PRO - DOCKER CONFIGURATION
# ============================================================================

# Docker socket - mounted from host
DOCKER_SOCKET=/var/run/docker.sock

# Docker network - ensure this exists on host
DOCKER_NETWORK=devflow_network

# Default versions
DEVFLOW_DEFAULT_PHP_VERSION=8.4
DEVFLOW_DEFAULT_NODE_VERSION=20

# Docker optimizations
DEVFLOW_DOCKER_BUILDKIT=true
DEVFLOW_DOCKER_RESTART_POLICY=unless-stopped

# ============================================================================
# DEVFLOW PRO - TIMEOUT SETTINGS
# ============================================================================

# Increase timeouts for Docker-in-Docker scenarios
DEVFLOW_TIMEOUT_DOCKER_INSTALL=300
DEVFLOW_TIMEOUT_DOCKER_COMPOSE_BUILD=1800
DEVFLOW_TIMEOUT_DOCKER_BUILD=900
DEVFLOW_TIMEOUT_DOCKER_COMPOSE_START=600
DEVFLOW_TIMEOUT_DOCKER_PULL=900
DEVFLOW_TIMEOUT_SYSTEM_PRUNE=300

DEVFLOW_TIMEOUT_BACKUP=1800
DEVFLOW_TIMEOUT_LOG_DOWNLOAD=120
DEVFLOW_TIMEOUT_HEALTH_CHECK=10
DEVFLOW_TIMEOUT_SSL_CHECK=30
DEVFLOW_TIMEOUT_COMMAND_EXEC=300

# ============================================================================
# DEVFLOW PRO - HEALTH CHECK SETTINGS
# ============================================================================

DEVFLOW_HEALTH_CHECK_INTERVAL=300
DEVFLOW_SSL_EXPIRY_WARNING_DAYS=7

# Resource thresholds
DEVFLOW_DISK_WARNING_THRESHOLD=75
DEVFLOW_CPU_WARNING_THRESHOLD=75
DEVFLOW_MEMORY_WARNING_THRESHOLD=75

DEVFLOW_DISK_CRITICAL_THRESHOLD=90
DEVFLOW_CPU_CRITICAL_THRESHOLD=90
DEVFLOW_MEMORY_CRITICAL_THRESHOLD=90

# ============================================================================
# DEVFLOW PRO - CACHE DURATIONS
# ============================================================================

DEVFLOW_CACHE_PROJECT_HEALTH=60
DEVFLOW_CACHE_SSL_CERTIFICATE=3600
DEVFLOW_CACHE_SERVER_METRICS=300
DEVFLOW_CACHE_CONTAINER_STATUS=30

# ============================================================================
# DEVFLOW PRO - NOTIFICATION SETTINGS
# ============================================================================

DEVFLOW_NOTIFICATIONS_EMAIL=true
DEVFLOW_NOTIFICATIONS_SLACK=false
DEVFLOW_NOTIFICATIONS_DISCORD=false

DEVFLOW_DEPLOYMENT_FAILURE_CHANNELS=email
DEVFLOW_HEALTH_CHECK_FAILURE_CHANNELS=email

# ============================================================================
# NGINX PROXY MANAGER INTEGRATION
# ============================================================================

# Use service name if Nginx Proxy Manager is in the same Docker network
NGINX_PROXY_MANAGER_URL=http://nginx-proxy-manager:81

# Or use external URL if on different server
# NGINX_PROXY_MANAGER_URL=http://192.168.1.10:81

NGINX_PROXY_MANAGER_EMAIL=admin@example.com
NGINX_PROXY_MANAGER_PASSWORD=

# ============================================================================
# GIT PROVIDER INTEGRATIONS
# ============================================================================

# GitHub
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=
GITHUB_WEBHOOK_SECRET=
GITHUB_TOKEN=

# GitLab
GITLAB_URL=https://gitlab.com
GITLAB_CLIENT_ID=
GITLAB_CLIENT_SECRET=
GITLAB_WEBHOOK_SECRET=
GITLAB_TOKEN=

# Bitbucket
BITBUCKET_URL=https://api.bitbucket.org/2.0
BITBUCKET_USERNAME=
BITBUCKET_APP_PASSWORD=
BITBUCKET_CLIENT_ID=
BITBUCKET_CLIENT_SECRET=
BITBUCKET_WEBHOOK_SECRET=

# ============================================================================
# CI/CD INTEGRATIONS
# ============================================================================

# Jenkins
JENKINS_URL=
JENKINS_USER=
JENKINS_TOKEN=

# Docker Registry
DOCKER_REGISTRY_URL=
DOCKER_REGISTRY_USERNAME=
DOCKER_REGISTRY_PASSWORD=

# ============================================================================
# NOTIFICATION SERVICES
# ============================================================================

# Slack
SLACK_WEBHOOK_URL=
SLACK_BOT_TOKEN=
SLACK_CHANNEL=#deployments

# Discord
DISCORD_WEBHOOK_URL=
DISCORD_BOT_TOKEN=

# ============================================================================
# ERROR TRACKING & MONITORING
# ============================================================================

# Sentry
SENTRY_LARAVEL_DSN=
SENTRY_TRACES_SAMPLE_RATE=1.0

# Telescope (disable in production)
TELESCOPE_ENABLED=false

# ============================================================================
# SYSTEM ADMINISTRATION
# ============================================================================

# Primary server (host machine)
DEVFLOW_PRIMARY_SERVER_IP=
DEVFLOW_PRIMARY_SERVER_USER=root
DEVFLOW_PRIMARY_SERVER_PORT=22

# System paths (inside container)
DEVFLOW_BACKUP_LOG_PATH=/var/www/backups/backup.log
DEVFLOW_BACKUP_DIR=/var/www/backups
DEVFLOW_MONITOR_LOG_PATH=/var/log/devflow-monitor.log
DEVFLOW_OPTIMIZATION_LOG_PATH=/var/log/devflow-db-optimization.log

# Scripts (inside container)
DEVFLOW_BACKUP_SCRIPT=/usr/local/bin/backup-databases.sh
DEVFLOW_OPTIMIZE_SCRIPT=/usr/local/bin/optimize-databases.sh

# ============================================================================
# METRICS & ANALYTICS
# ============================================================================

METRICS_RETENTION_DAYS=30

# ============================================================================
# VITE CONFIGURATION
# ============================================================================

VITE_APP_NAME="${APP_NAME}"
VITE_REVERB_APP_KEY="${REVERB_APP_KEY}"
VITE_REVERB_HOST="${REVERB_HOST}"
VITE_REVERB_PORT="${REVERB_PORT}"
VITE_REVERB_SCHEME="${REVERB_SCHEME}"

# ============================================================================
# DOCKER DEPLOYMENT NOTES
# ============================================================================
#
# 1. Service Names:
#    - Always use Docker service names instead of 'localhost' or '127.0.0.1'
#    - Example: postgres, redis, nginx, mailhog
#
# 2. Networking:
#    - Ensure all services are on the same Docker network
#    - Create network: docker network create devflow_network
#    - Configure in docker-compose.yml
#
# 3. Volume Mapping:
#    - Map container paths to host paths in docker-compose.yml
#    - Example: /var/www/projects:/opt/devflow/projects
#    - Ensure proper permissions on host directories
#
# 4. Environment Variables:
#    - Generate APP_KEY before first run: docker-compose run app php artisan key:generate
#    - Generate REVERB keys if using WebSockets
#
# 5. Docker Socket Access:
#    - Mount Docker socket for container management
#    - volumes: - /var/run/docker.sock:/var/run/docker.sock
#    - Be aware of security implications
#
# 6. Database Initialization:
#    - Run migrations after first start
#    - docker-compose exec app php artisan migrate --force
#
# 7. Queue Workers:
#    - Start queue workers in separate container or with supervisor
#    - docker-compose exec app php artisan queue:work
#
# 8. SSL Certificates:
#    - Use Let's Encrypt with Nginx Proxy Manager
#    - Or mount certificates as volumes
#
# 9. Backups:
#    - Configure regular backups of volumes
#    - Map backup directory to host for persistence
#
# 10. Monitoring:
#     - Consider using Portainer for container monitoring
#     - Monitor logs: docker-compose logs -f app
#
# ============================================================================
